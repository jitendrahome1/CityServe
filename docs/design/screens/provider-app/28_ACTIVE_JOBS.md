# Active Jobs

## Overview
- **Screen ID**: 28
- **Screen Name**: Active Jobs List
- **User Flow**: View and manage accepted jobs
- **Navigation**: From Dashboard, Bottom Tab "Jobs" â†’ "Active" tab

## ASCII Wireframe

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Active Jobs                    [Filter] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚Upcoming  â”‚ â”‚In Progressâ”‚ â”‚Completedâ”‚ â”‚ â† Tabs
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  (selected)                              â”‚
â”‚                                          â”‚
â”‚  Today                                   â”‚ â† Date Group
â”‚                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ”¥ Starting in 45 minutes           â”‚ â”‚ â† Urgent Job
â”‚  â”‚                                    â”‚ â”‚
â”‚  â”‚ ğŸ”§ AC Repair & Service             â”‚ â”‚
â”‚  â”‚ #BK789012                          â”‚ â”‚
â”‚  â”‚                                    â”‚ â”‚
â”‚  â”‚ ğŸ“ HSR Layout â€¢ 5.2 km             â”‚ â”‚
â”‚  â”‚ â° 2:00 PM - 3:30 PM               â”‚ â”‚
â”‚  â”‚ ğŸ‘¤ Amit Kumar                      â”‚ â”‚
â”‚  â”‚ ğŸ’° â‚¹650 (You earn â‚¹552)            â”‚ â”‚
â”‚  â”‚                                    â”‚ â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚ â”‚ ğŸ“ Call  â”‚ ğŸ—ºï¸ Navigate  â”‚ â–¶ï¸ Startâ”‚ â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ’¡ Electrical Work                  â”‚ â”‚ â† Scheduled Job
â”‚  â”‚ #BK789013                          â”‚ â”‚
â”‚  â”‚                                    â”‚ â”‚
â”‚  â”‚ ğŸ“ Koramangala â€¢ 3.1 km            â”‚ â”‚
â”‚  â”‚ â° 5:00 PM - 6:00 PM               â”‚ â”‚
â”‚  â”‚ ğŸ‘¤ Priya Sharma                    â”‚ â”‚
â”‚  â”‚ ğŸ’° â‚¹450 (You earn â‚¹382)            â”‚ â”‚
â”‚  â”‚                                    â”‚ â”‚
â”‚  â”‚ Starts in 4 hours 30 minutes       â”‚ â”‚
â”‚  â”‚                                    â”‚ â”‚
â”‚  â”‚ [View Details] [Get Directions]    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                          â”‚
â”‚  Tomorrow                                â”‚
â”‚                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸš¿ Plumbing Service                 â”‚ â”‚
â”‚  â”‚ #BK789014                          â”‚ â”‚
â”‚  â”‚                                    â”‚ â”‚
â”‚  â”‚ ğŸ“ Indiranagar â€¢ 6.8 km            â”‚ â”‚
â”‚  â”‚ â° 10:00 AM - 11:00 AM             â”‚ â”‚
â”‚  â”‚ ğŸ‘¤ Rahul Singh                     â”‚ â”‚
â”‚  â”‚ ğŸ’° â‚¹550 (You earn â‚¹467)            â”‚ â”‚
â”‚  â”‚                                    â”‚ â”‚
â”‚  â”‚ [View Details] [Reschedule]        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Job States

### Upcoming (Not Started)
- **Urgent**: < 1 hour to start (orange badge)
- **Today**: Same day
- **Future**: Tomorrow onwards

**Actions**:
- Call customer
- Get directions
- View details
- Start (if within start window)
- Reschedule (if > 2 hours)
- Cancel (emergency only, penalty applies)

### In Progress
- Job started by provider
- Service being performed
- Real-time updates

**Actions**:
- Update status
- Add notes/photos
- Request additional charges
- Mark complete
- Contact customer

### Completed (Today)
- Finished jobs
- Payment processing
- Review pending

**Actions**:
- View summary
- Download invoice
- View review (if customer reviewed)

## Key Features

### Urgency Indicators
- **< 30 min**: Red banner "Starting soon!"
- **< 1 hour**: Orange badge "Urgent"
- **< 3 hours**: Yellow badge "Today"
- **Tomorrow**: Normal display

### Quick Actions
- **Call**: Direct call to customer
- **Navigate**: Open Maps with route
- **Start**: Begin job (enabled within 15 min window)
- **View Details**: Full job information

### Job Cards
```swift
struct ActiveJobCard: View {
    let job: Job

    var urgencyBadge: some View {
        if job.minutesUntilStart < 30 {
            HStack {
                Image(systemName: "exclamationmark.triangle.fill")
                Text("Starting in \(job.minutesUntilStart) minutes!")
            }
            .foregroundColor(.white)
            .padding(.horizontal, 12)
            .padding(.vertical, 6)
            .background(Color.red)
            .cornerRadius(6)
        }
    }

    var body: some View {
        VStack(alignment: .leading, spacing: 12) {
            urgencyBadge

            HStack {
                Text(job.service.icon)
                    .font(.system(size: 24))
                VStack(alignment: .leading) {
                    Text(job.service.name)
                        .font(.custom("Inter-SemiBold", size: 17))
                    Text("#\(job.bookingId)")
                        .font(.system(size: 12, design: .monospaced))
                        .foregroundColor(.secondary)
                }
            }

            // Location, time, customer, payment...

            HStack(spacing: 12) {
                if job.canCall {
                    ActionButton(icon: "phone.fill", title: "Call")
                }
                if job.canNavigate {
                    ActionButton(icon: "map.fill", title: "Navigate")
                }
                if job.canStart {
                    PrimaryButton(title: "Start Job")
                }
            }
        }
        .padding()
        .background(Color.white)
        .cornerRadius(12)
        .shadow(radius: 2)
    }
}
```

## Interactions

### Start Job
- Verify location (must be near customer)
- Confirm start time
- Notify customer
- Navigate to Job In Progress screen

### Call Customer
- Show customer phone
- Initiate call
- Log communication

### Navigate
- Open Apple Maps/Google Maps
- Route to customer location
- ETA calculation

### View Details
- Navigate to full job detail screen
- All information visible

### Reschedule
- Only if > 2 hours away
- Show available slots
- Notify customer
- Admin approval may be needed

### Cancel (Emergency)
- Show warning (penalty applies)
- Require reason
- Contact support automatically
- Affects provider rating

## Real-time Updates
- Job status changes
- Customer messages
- Time countdown
- Location proximity alerts

## Empty States
- **No Upcoming**: "No upcoming jobs. Accept requests from the Jobs tab."
- **No In Progress**: "No jobs in progress"
- **No Completed Today**: "No jobs completed today"

## Analytics
- `active_jobs_viewed`: Screen loaded
- `job_started`: Start button clicked
- `customer_called_from_active`: Call initiated
- `navigation_opened`: Directions requested
- `job_rescheduled`: Reschedule completed
- `job_cancelled_emergency`: Emergency cancellation
